"use strict";(self["webpackChunkweek6_test01"]=self["webpackChunkweek6_test01"]||[]).push([[9],{530:function(t,e,i){function s(t){return{all:t=t||new Map,on:function(e,i){var s=t.get(e);s?s.push(i):t.set(e,[i])},off:function(e,i){var s=t.get(e);s&&(i?s.splice(s.indexOf(i)>>>0,1):t.set(e,[]))},emit:function(e,i){var s=t.get(e);s&&s.slice().map((function(t){t(i)})),(s=t.get("*"))&&s.slice().map((function(t){t(e,i)}))}}}i.d(e,{Z:function(){return a}});const n=s();var a=n},9:function(t,e,i){i.r(e),i.d(e,{default:function(){return O}});var s=i(252),n=i(577),a=i(963);const o=(0,s._)("h2",null,"購物車列表",-1),l={class:"container"},c={class:"row"},r={class:"table align-middle"},d=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"圖片"),(0,s._)("th",null,"商品名稱"),(0,s._)("th",null,"價格"),(0,s._)("th")])],-1),u={style:{width:"200px"}},h={key:0,class:"h5"},p={key:1},g={class:"h6"},_={class:"h5"},b={class:"btn-group btn-group-sm"},v=["disabled","onClick"],m={class:"spinner-border spinner-border-sm",role:"status"},y=(0,s._)("span",{class:"visually-hidden"},"Loading...",-1),w=[y],C=(0,s.Uk)(" 加到購物車 "),f={class:"text-end"},k=["disabled"],x={class:"table align-middle"},D=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th"),(0,s._)("th",null,"品名"),(0,s._)("th",{style:{width:"150px"}},"數量/單位"),(0,s._)("th",null,"單價")])],-1),$=["onClick"],z={class:"input-group input-group-sm"},I={class:"input-group mb-3"},L=["onChange","disabled","onUpdate:modelValue"],q=["value"],A={class:"input-group-text",id:"basic-addon2"},H={class:"text-end"},U=(0,s._)("td",{colspan:"3",class:"text-end"},"總計",-1),Y={class:"text-end"};function K(t,e,i,y,K,Z){return(0,s.wg)(),(0,s.iD)(s.HY,null,[o,(0,s._)("div",l,[(0,s._)("div",c,[(0,s._)("table",r,[d,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(K.products,(t=>((0,s.wg)(),(0,s.iD)("tbody",{key:t.id+"product"},[(0,s._)("tr",null,[(0,s._)("td",u,[(0,s._)("div",{style:(0,n.j5)([{backgroundImage:`url(${t.imageUrl})`},{height:"100px","background-size":"cover","background-position":"center"}])},null,4)]),(0,s._)("td",null,(0,n.zw)(t.title),1),(0,s._)("td",null,[t.price===t.origin_price?((0,s.wg)(),(0,s.iD)("div",h,(0,n.zw)(t.price)+" 元 ",1)):((0,s.wg)(),(0,s.iD)("div",p,[(0,s._)("del",g,"原價 "+(0,n.zw)(t.origin_price)+" 元",1),(0,s._)("div",_,"現在只要 "+(0,n.zw)(t.price)+" 元",1)]))]),(0,s._)("td",null,[(0,s._)("div",b,[(0,s._)("button",{disabled:K.isLoadingItem===t.id,type:"button",class:"btn btn-outline-danger",onClick:e=>Z.addToCart(t)},[(0,s.wy)((0,s._)("div",m,w,512),[[a.F8,K.isLoadingItem===t.id]]),C],8,v)])])])])))),128))]),(0,s._)("div",f,[(0,s._)("button",{onClick:e[0]||(e[0]=(...t)=>Z.deleteAllCart&&Z.deleteAllCart(...t)),disabled:0===K.cart.carts.length,class:"btn btn-outline-danger",type:"button"},"清空購物車",8,k)]),(0,s._)("table",x,[D,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(K.cartData.carts,((t,e)=>((0,s.wg)(),(0,s.iD)("tr",{key:e+"cart"},[(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>Z.deleteACart(t.id)}," x ",8,$)]),(0,s._)("td",null,(0,n.zw)(t.product.title),1),(0,s._)("td",null,[(0,s._)("div",z,[(0,s._)("div",I,[(0,s.wy)((0,s._)("select",{onChange:e=>Z.putCartNum(t),disabled:K.isLoadingItem===t.id,"onUpdate:modelValue":e=>t.qty=e,class:"form-select"},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,(e=>(0,s._)("option",{value:e,key:`${e}${t.product_id}`},(0,n.zw)(e),9,q))),64))],40,L),[[a.bM,t.qty]]),(0,s._)("span",A,(0,n.zw)(t.product.unit),1)])])]),(0,s._)("td",H,(0,n.zw)(t.product.price),1)])))),128))]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[U,(0,s._)("td",Y,(0,n.zw)(K.cartData.total),1)])])])])])],64)}var Z=i(530),F={data(){return{products:[],productId:"",cartData:{},isLoadingItem:"",cart:{carts:[]}}},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/v2/api/peiying/products/all";this.$http(t).then((t=>{console.log(t),this.products=t.data.products})).catch((t=>{console.log(t)}))},addToCart(t,e=1){this.isLoadingItem=t.id;const i="https://vue3-course-api.hexschool.io/v2/api/peiying/cart",s={product_id:t.id,qty:e};console.log(s),this.$http.post(i,{data:s}).then((e=>{alert(`『 ${t.title} 』已加入購物車`),this.renderCart(),this.isLoadingItem="",Z.Z.emit("render-cart")})).catch((t=>{console.log(t)}))},deleteACart(t){const e=`https://vue3-course-api.hexschool.io/v2/api/peiying/cart/${t}`;this.$http.delete(e).then((t=>{console.log(t),this.renderCart()})).catch((t=>{console.log(t)}))},deleteAllCart(){const t="https://vue3-course-api.hexschool.io/v2/api/peiying/carts";this.$http.delete(t).then((t=>{console.log(t),this.renderCart()})).catch((t=>{console.log(t)}))},renderCart(){const t="https://vue3-course-api.hexschool.io/v2/api/peiying/cart";this.$http(t).then((t=>{this.cartData=t.data.data,console.log(this.cartData),0===this.cartData.carts.length?this.cart={carts:[]}:this.cart={carts:[1]}})).catch((t=>{console.log(t)}))},putCartNum(t){this.isLoadingItem=t.id;const e=`https://vue3-course-api.hexschool.io/v2/api/peiying/cart/${t.id}`,i={product_id:t.id,qty:t.qty};this.$http.put(e,{data:i}).then((t=>{this.isLoadingItem="",this.renderCart()})).catch((t=>{console.dir(t)}))},postOrder(){const t="https://vue3-course-api.hexschool.io/v2/api/peiying/order";this.$http.post(t,{data:this.userData}).then((t=>{console.log(t),this.$refs.form.resetForm(),this.renderCart()})).catch((t=>{console.log(t)}))}},mounted(){this.getProducts(),this.renderCart()}},M=i(744);const N=(0,M.Z)(F,[["render",K]]);var O=N}}]);
//# sourceMappingURL=9.a8efec26.js.map